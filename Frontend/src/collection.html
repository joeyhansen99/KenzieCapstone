<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="UTF-8" />
<!--        <script type="text/html" src="collectionPage.js"></script>-->
        <script type="text/javascript" src="collectionPage.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" charset="utf-8"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" charset="utf-8"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" />
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
    </head>

    <!-- Navigation Bar -->
    <body id="collectionPage">
        <div class="collectionHero">
            <nav class="collectionNavMenu">
                <div class="collectionNavLogo">
                    MTG CARD<br>COMPENDIUM
                </div>
                <div class="collectionNavSearchBox">
                    <form action="">
                        <input type="text" id="collectionSearchInput" onkeyup="searchCollection()"
                               placeholder="Search in Collection by Name">
                        <button id="collectionSearchButton" type="submit"><i class="fas fa-search"></i></button>
                    </form>
                </div>
                <ul class="collectionNavMenuItems">
                    <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="collection.html"><i class="fas fa-archive"></i> Collection</a></li>
                    <li><a href="addcard.html"><i class="fas fa-plus-square"></i> Add Card</a></li>
<!--                    <li><a href="#"><i class="fas fa-edit"></i> Edit</a></li>-->
<!--                    <li><a href="#"><i class="fas fa-trash"></i> Delete</a></li>-->
<!--                    <li><a href="#"><i class="fas fa-sign-out"></i> Log-Out</a></li>-->
                </ul>
            </nav>
        </div>
        <!-- Collection Table -->
        <div class="mainCollection-OuterWrapper">
            <div class="mainCollection-TableWrapper">
                <table id="collectionTable" class="mainCollection table-sortable">
                    <thead>
                        <tr id="collectionTableHeader">
                            <th>Set   <i class="fas fa-sort-asc"></i></th>
                            <th>Name   <i class="fas fa-sort-asc"></i></th>
                            <th>CMC   <i class="fas fa-sort-asc"></i></th>
                            <th>Type   <i class="fas fa-sort-asc"></i></th>
                            <th>Color   <i class="fas fa-sort-asc"></i></th>
                            <th>Rarity   <i class="fas fa-sort-asc"></i></th>
                            <th>Foil   <i class="fas fa-sort-asc"></i></th>
                            <th>Full Art   <i class="fas fa-sort-asc"></i></th>
                            <th>Qty   <i class="fas fa-sort-asc"></i></th>
                            <th>Actions</th>
                        </tr>
                    </thead>
<!--                <tbody id="collectionDataYes"></tbody>-->
                    <tbody class="testCollectionData"></tbody>
                </table>
<!--                <  id="collectionDataNo" style="text-align: center;">No cards found in your collection.</h6>-->
                <script>
                    // Filter Table based off search input -------------------------------------------------------------
                    //CODE CITE: https://www.w3schools.com/howto/howto_js_filter_table.asp
                    function searchCollection() {
                        // Declare variables
                        var input, filter, table, tr, td, i, txtValue; //declares variables
                        input = document.getElementById("collectionSearchInput"); //getting the inputed value
                        filter = collectionSearchInput.value.toUpperCase(); //change what ppl enter to uppercase
                        table = document.getElementById("collectionTable");
                        tr = table.getElementsByTagName("tr");

                        // Loop through all table rows, and hide those who don't match the search query
                        for (i = 0; i < tr.length; i++) {
                            td = tr[i].getElementsByTagName("td")[1]; //search off card name
                            if (td) {
                              txtValue = td.textContent || td.innerText;
                              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                tr[i].style.display = "";
                              } else {
                                tr[i].style.display = "none";
                              }
                            }
                        }
                    }
                </script>
                <script>
                    // Sort Table --------------------------------------------------------------------------------------
                    //CODE CITE: https://www.w3schools.com/howto/howto_js_sort_table.asp & https://www.youtube.com/watch?v=QxbJ9b-mpoA
                    tableHeaders = document.getElementsByTagName('th');
                    for (let tableColumns = 0; tableColumns < tableHeaders.length-1; tableColumns++) {
                        tableHeaders[tableColumns].addEventListener('click', sorter(tableColumns));
                    }

                    function sorter(tableColumns) {
                        return function() {
                            sortTable(tableColumns);
                        }
                    }

                    function sortTable(tableColumns) {
                        var table, rows, switching, i, x, y, shouldSwitch;
                        table = document.getElementById("collectionTable");
                        switching = true;
                        /* Make a loop that will continue until no switching has been done: */
                        while (switching) {
                            switching = false;
                            rows = table.rows;
                            /* Loop through all table rows (except the first, which contains table headers): */
                            for (i = 1; i < (rows.length - 1); i++) {
                                // Start by saying there should be no switching:
                                shouldSwitch = false;
                                /* Get the two elements you want to compare, one from current row and one from the next: */
                                x = rows[i].getElementsByTagName("TD")[tableColumns];
                                y = rows[i + 1].getElementsByTagName("TD")[tableColumns];
                                // Check if the two rows should switch place:
                                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                                    // If so, mark as a switch and break the loop:
                                    shouldSwitch = true;
                                    break;
                                }
                            }
                            if (shouldSwitch) {
                                /* If a switch has been marked, make the switch and mark that a switch has been done: */
                                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                                switching = true;
                            }
                        }
                    }
                </script>
            </div>
        </div>
    </body>
</html>
